{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"admin-login\"\n};\nconst _hoisted_2 = {\n  class: \"login-form\"\n};\nconst _hoisted_3 = {\n  class: \"form-group\"\n};\nconst _hoisted_4 = {\n  class: \"form-group\"\n};\nconst _hoisted_5 = [\"disabled\"];\nconst _hoisted_6 = {\n  key: 0,\n  class: \"error\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[7] || (_cache[7] = _createElementVNode(\"h1\", null, \"Вход в админ-панель\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n    for: \"username\"\n  }, \"Логин\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"username\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.username = $event),\n    placeholder: \"Введите логин\",\n    onKeyup: _cache[1] || (_cache[1] = _withKeys((...args) => $options.login && $options.login(...args), [\"enter\"]))\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $data.username]])]), _createElementVNode(\"div\", _hoisted_4, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    for: \"password\"\n  }, \"Пароль\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    id: \"password\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.password = $event),\n    placeholder: \"Введите пароль\",\n    onKeyup: _cache[3] || (_cache[3] = _withKeys((...args) => $options.login && $options.login(...args), [\"enter\"]))\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $data.password]])]), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.login && $options.login(...args)),\n    disabled: $data.loading\n  }, _toDisplayString($data.loading ? 'Вход...' : 'Войти'), 9 /* TEXT, PROPS */, _hoisted_5), $data.errorMessage ? (_openBlock(), _createElementBlock(\"p\", _hoisted_6, _toDisplayString($data.errorMessage), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","for","type","id","$data","username","$event","placeholder","onKeyup","_cache","_withKeys","args","$options","login","_hoisted_4","password","onClick","disabled","loading","_hoisted_5","errorMessage","_hoisted_6","_toDisplayString"],"sources":["C:\\Users\\Zemek\\OneDrive\\Desktop\\IP_Belkin_final_stage\\frontend\\src\\components\\AdminLogin.vue"],"sourcesContent":["<template>\r\n  <div class=\"admin-login\">\r\n    <h1>Вход в админ-панель</h1>\r\n    <div class=\"login-form\">\r\n      <div class=\"form-group\">\r\n        <label for=\"username\">Логин</label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"username\"\r\n          v-model=\"username\"\r\n          placeholder=\"Введите логин\"\r\n          @keyup.enter=\"login\"\r\n        />\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"password\">Пароль</label>\r\n        <input\r\n          type=\"password\"\r\n          id=\"password\"\r\n          v-model=\"password\"\r\n          placeholder=\"Введите пароль\"\r\n          @keyup.enter=\"login\"\r\n        />\r\n      </div>\r\n      <button @click=\"login\" :disabled=\"loading\">\r\n        {{ loading ? 'Вход...' : 'Войти' }}\r\n      </button>\r\n      <p v-if=\"errorMessage\" class=\"error\">{{ errorMessage }}</p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  name: 'AdminLogin',\r\n  data() {\r\n    return {\r\n      username: '',\r\n      password: '',\r\n      loading: false,\r\n      errorMessage: '',\r\n      backendPort: 'http://212.192.127.152:9000'\r\n    };\r\n  },\r\n    methods: {\r\n    async login() {\r\n      \r\n      if (!this.username || !this.password) {\r\n        this.errorMessage = 'Пожалуйста, заполните все поля';\r\n        return;\r\n      }\r\n\r\n      \r\n      if (this.username.length < 3 || this.username.length > 50) {\r\n        this.errorMessage = 'Логин должен содержать от 3 до 50 символов';\r\n        return;\r\n      }\r\n      if (this.password.length < 8) {\r\n        this.errorMessage = 'Пароль должен содержать минимум 8 символов';\r\n        return;\r\n      }\r\n      \r\n      const usernameRegex = /^[a-zA-Z0-9_]+$/;\r\n      if (!usernameRegex.test(this.username)) {\r\n        this.errorMessage = 'Логин содержит недопустимые символы';\r\n        return;\r\n      }\r\n\r\n      \r\n      this.loading = true;\r\n      this.errorMessage = '';\r\n\r\n      try {\r\n        \r\n        const response = await axios.post(\r\n          \"http://212.192.127.152:9000/user/\", \r\n          {\r\n            login: this.username,\r\n            password: this.password\r\n          },\r\n          {\r\n            withCredentials: true,\r\n            timeout: 10000, \r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              'X-Requested-With': 'XMLHttpRequest' \r\n            }\r\n          }\r\n        );\r\n\r\n        \r\n        if (!response.data || typeof response.data !== 'object') {\r\n          throw new Error('Некорректный формат ответа сервера');\r\n        }\r\n\r\n        console.log(response.data.token);\r\n        if (response.data.token) {\r\n          \r\n          localStorage.setItem('authToken', response.data.token);\r\n\r\n          \r\n          this.username = '';\r\n          this.password = '';\r\n\r\n          \r\n          await this.$router.push('/admin');\r\n        } else {\r\n          \r\n          this.errorMessage = response.data.message || 'Ошибка аутентификации: токен не получен';\r\n        }\r\n      } catch (error) {\r\n        \r\n        if (error.response) {\r\n          \r\n          const status = error.response.status;\r\n          const message = error.response.data?.message || 'Произошла ошибка на сервере';\r\n\r\n          switch (status) {\r\n            case 400:\r\n              this.errorMessage = 'Некорректный запрос. Проверьте данные и попробуйте снова';\r\n              break;\r\n            case 401:\r\n              this.errorMessage = 'Неверный логин или пароль';\r\n              break;\r\n            case 403:\r\n              this.errorMessage = 'Доступ запрещен';\r\n              break;\r\n            case 429:\r\n              this.errorMessage = 'Слишком много попыток. Пожалуйста, подождите 5 минут';\r\n              break;\r\n            case 500:\r\n              this.errorMessage = 'Внутренняя ошибка сервера. Попробуйте позже';\r\n              break;\r\n            default:\r\n              this.errorMessage = message;\r\n          }\r\n        } else if (error.request) {\r\n          \r\n          this.errorMessage = 'Сервер недоступен. Проверьте подключение к интернету';\r\n        } else if (error.code === 'ECONNABORTED') {\r\n          \r\n          this.errorMessage = 'Время ожидания истекло. Попробуйте снова';\r\n        } else {\r\n          \r\n          this.errorMessage = 'Произошла неизвестная ошибка. Пожалуйста, попробуйте снова';\r\n        }\r\n\r\n        // Логирование ошибки для отладки\r\n        console.error('Ошибка входа:', {\r\n          message: error.message,\r\n          code: error.code,\r\n          response: error.response ? {\r\n            status: error.response.status,\r\n            data: error.response.data\r\n          } : null\r\n        });\r\n      } finally {\r\n        // Сброс состояния загрузки и поля пароля\r\n        this.loading = false;\r\n        this.password = ''; // Сбрасываем пароль для безопасности\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.admin-login {\r\n  width: 100%;\r\n  min-height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: #f5f7fa;\r\n  font-family: 'Nekst', sans-serif;\r\n  padding: 2rem;\r\n}\r\n\r\nh1 {\r\n  font-family: 'Nekst-SemiBold', sans-serif;\r\n  font-size: clamp(2rem, 3.5vw, 4rem);\r\n  color: #1a202c;\r\n  margin-bottom: 3vh;\r\n}\r\n\r\n.login-form {\r\n  width: 100%;\r\n  max-width: 400px;\r\n  background-color: #fff;\r\n  padding: 2rem;\r\n  border-radius: 10px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 1.5rem;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  font-family: 'Nekst-Medium', sans-serif;\r\n  font-size: clamp(1rem, 1.2vw, 1.2rem);\r\n  color: #4a5568;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\ninput {\r\n  width: 100%;\r\n  padding: 0.75rem;\r\n  border: 1px solid #e0e0e0;\r\n  border-radius: 5px;\r\n  font-family: 'Nekst-Light', sans-serif;\r\n  font-size: clamp(1rem, 1.2vw, 1.2rem);\r\n  color: #1a202c;\r\n  outline: none;\r\n  transition: border-color 0.3s;\r\n}\r\n\r\ninput:focus {\r\n  border-color: #5552e8;\r\n}\r\n\r\nbutton {\r\n  width: 100%;\r\n  padding: 0.75rem;\r\n  background-color: #5552e8;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 5px;\r\n  font-family: 'Nekst-Medium', sans-serif;\r\n  font-size: clamp(1rem, 1.2vw, 1.2rem);\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\nbutton:disabled {\r\n  background-color: #a0a0a0;\r\n  cursor: not-allowed;\r\n}\r\n\r\nbutton:hover:not(:disabled) {\r\n  background-color: #4542c8;\r\n}\r\n\r\n.error {\r\n  color: #e53e3e;\r\n  font-family: 'Nekst-Light', sans-serif;\r\n  font-size: clamp(0.9rem, 1vw, 1rem);\r\n  margin-top: 1rem;\r\n  text-align: center;\r\n}\r\n\r\n/* Адаптивность для мобильных устройств */\r\n@media (max-width: 768px) {\r\n  .admin-login {\r\n    padding: 1rem;\r\n  }\r\n\r\n  h1 {\r\n    font-size: clamp(1.5rem, 5vw, 2rem);\r\n  }\r\n\r\n  .login-form {\r\n    padding: 1.5rem;\r\n  }\r\n\r\n  input,\r\n  button {\r\n    font-size: clamp(0.9rem, 3vw, 1rem);\r\n  }\r\n}\r\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAa;;EAEjBA,KAAK,EAAC;AAAY;;EAChBA,KAAK,EAAC;AAAY;;EAUlBA,KAAK,EAAC;AAAY;;;;EAaAA,KAAK,EAAC;;;uBA1BjCC,mBAAA,CA4BM,OA5BNC,UA4BM,G,0BA3BJC,mBAAA,CAA4B,YAAxB,qBAAmB,sBACvBA,mBAAA,CAyBM,OAzBNC,UAyBM,GAxBJD,mBAAA,CASM,OATNE,UASM,G,0BARJF,mBAAA,CAAmC;IAA5BG,GAAG,EAAC;EAAU,GAAC,OAAK,sB,gBAC3BH,mBAAA,CAME;IALAI,IAAI,EAAC,MAAM;IACXC,EAAE,EAAC,UAAU;+DACJC,KAAA,CAAAC,QAAQ,GAAAC,MAAA;IACjBC,WAAW,EAAC,eAAe;IAC1BC,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,SAAA,KAAAC,IAAA,KAAQC,QAAA,CAAAC,KAAA,IAAAD,QAAA,CAAAC,KAAA,IAAAF,IAAA,CAAK;iEAFVP,KAAA,CAAAC,QAAQ,E,KAKrBP,mBAAA,CASM,OATNgB,UASM,G,0BARJhB,mBAAA,CAAoC;IAA7BG,GAAG,EAAC;EAAU,GAAC,QAAM,sB,gBAC5BH,mBAAA,CAME;IALAI,IAAI,EAAC,UAAU;IACfC,EAAE,EAAC,UAAU;+DACJC,KAAA,CAAAW,QAAQ,GAAAT,MAAA;IACjBC,WAAW,EAAC,gBAAgB;IAC3BC,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,SAAA,KAAAC,IAAA,KAAQC,QAAA,CAAAC,KAAA,IAAAD,QAAA,CAAAC,KAAA,IAAAF,IAAA,CAAK;iEAFVP,KAAA,CAAAW,QAAQ,E,KAKrBjB,mBAAA,CAES;IAFAkB,OAAK,EAAAP,MAAA,QAAAA,MAAA,UAAAE,IAAA,KAAEC,QAAA,CAAAC,KAAA,IAAAD,QAAA,CAAAC,KAAA,IAAAF,IAAA,CAAK;IAAGM,QAAQ,EAAEb,KAAA,CAAAc;sBAC7Bd,KAAA,CAAAc,OAAO,8CAAAC,UAAA,GAEHf,KAAA,CAAAgB,YAAY,I,cAArBxB,mBAAA,CAA2D,KAA3DyB,UAA2D,EAAAC,gBAAA,CAAnBlB,KAAA,CAAAgB,YAAY,oB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}